<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="confing/mappers.base_judging">
  <resultMap id="BaseResultMap" type="com.hz.demo.model.base_judging">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Sep 13 15:09:53 CST 2018.
    -->
    <id column="ID" jdbcType="DECIMAL" property="id" />
    <result column="JUDGING_CODE" jdbcType="VARCHAR" property="judgingCode" />
    <result column="JUDGING_NAME" jdbcType="VARCHAR" property="judgingName" />
    <result column="REVIEW_JURISDICTION" jdbcType="VARCHAR" property="reviewJurisdiction" />
    <result column="REVIEW_SCOPE" jdbcType="VARCHAR" property="reviewScope" />
    <result column="BUILD_UNIT" jdbcType="VARCHAR" property="buildUnit" />
    <result column="MANAGE_UNIT" jdbcType="VARCHAR" property="manageUnit" />
    <result column="LINKMAN" jdbcType="VARCHAR" property="linkman" />
    <result column="PHONE" jdbcType="VARCHAR" property="phone" />
    <result column="EMAIL" jdbcType="VARCHAR" property="email" />
    <result column="POSTAL_CODE" jdbcType="VARCHAR" property="postalCode" />
    <result column="FAX" jdbcType="VARCHAR" property="fax" />
    <result column="JURY_LEVEL" jdbcType="VARCHAR" property="juryLevel" />
    <result column="RECORD_DATE" jdbcType="TIMESTAMP" property="recordDate" />
    <result column="ADDTIME" jdbcType="TIMESTAMP" property="addtime" />
    <result column="ADDUSERID" jdbcType="VARCHAR" property="adduserid" />
    <result column="STATE" jdbcType="DECIMAL" property="state" />
    <result column="BACK1" jdbcType="VARCHAR" property="back1" />
    <result column="BACK2" jdbcType="VARCHAR" property="back2" />
    <result column="BACK3" jdbcType="VARCHAR" property="back3" />
    <result column="JUDGING_PROPORTION" jdbcType="VARCHAR" property="judgingProportion" />
  </resultMap>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Sep 13 15:09:53 CST 2018.
    -->
    ID, JUDGING_CODE, JUDGING_NAME, REVIEW_JURISDICTION, REVIEW_SCOPE, BUILD_UNIT, MANAGE_UNIT,
    LINKMAN, PHONE, EMAIL, POSTAL_CODE, FAX, JURY_LEVEL, RECORD_DATE, ADDTIME, ADDUSERID,
    STATE, BACK1, BACK2, BACK3
  </sql>
  <select id="selectByPrimaryKey" parameterType="java.lang.Integer" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Sep 13 15:09:53 CST 2018.
    -->
    select
    <include refid="Base_Column_List" />
    from BASE_JUDGING
    where ID = #{id,jdbcType=DECIMAL}
  </select>


  <select id="selectById" parameterType="java.lang.Integer" resultMap="BaseResultMap">
    select g.ID, g.JUDGING_CODE, g.JUDGING_NAME, g.REVIEW_JURISDICTION, g.REVIEW_SCOPE,g.BUILD_UNIT,d.unit_name as MANAGE_UNIT, g.LINKMAN, g.PHONE, g.EMAIL,g.POSTAL_CODE, g.FAX, g.JURY_LEVEL, g.RECORD_DATE, g.ADDTIME, g.ADDUSERID, g.STATE, g.BACK1, g.BACK2, g.BACK3 from(
    select a.ID, a.JUDGING_CODE, a.JUDGING_NAME, a.REVIEW_JURISDICTION, a.REVIEW_SCOPE, b.unit_name as BUILD_UNIT, a.MANAGE_UNIT, a.LINKMAN, a.PHONE, a.EMAIL, a.POSTAL_CODE, a.FAX, a.JURY_LEVEL, a.RECORD_DATE, a.ADDTIME, a.ADDUSERID, a.STATE, a.BACK1, a.BACK2, a.BACK3 	from (
    select * from base_judging WHERE ID = #{id,jdbcType=DECIMAL}) a left join base_unit b on a.BUILD_UNIT = b.unit_code ) g left join base_unit d on g.MANAGE_UNIT = d.unit_code
  </select>



  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Sep 13 15:09:53 CST 2018.
    -->
    delete from BASE_JUDGING
    where ID = #{id,jdbcType=DECIMAL}
  </delete>
  <insert id="insert" parameterType="com.hz.demo.model.base_judging">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Sep 13 15:09:53 CST 2018.
    -->
    insert into BASE_JUDGING (ID, JUDGING_CODE, JUDGING_NAME,
    REVIEW_JURISDICTION, REVIEW_SCOPE, BUILD_UNIT,
    MANAGE_UNIT, LINKMAN, PHONE,
    EMAIL, POSTAL_CODE, FAX,
    JURY_LEVEL, RECORD_DATE, ADDTIME,
    ADDUSERID, STATE, BACK1,
    BACK2, BACK3)
    values (#{id,jdbcType=DECIMAL}, #{judgingCode,jdbcType=VARCHAR}, #{judgingName,jdbcType=VARCHAR},
    #{reviewJurisdiction,jdbcType=VARCHAR}, #{reviewScope,jdbcType=VARCHAR}, #{buildUnit,jdbcType=VARCHAR},
    #{manageUnit,jdbcType=VARCHAR}, #{linkman,jdbcType=VARCHAR}, #{phone,jdbcType=VARCHAR},
    #{email,jdbcType=VARCHAR}, #{postalCode,jdbcType=VARCHAR}, #{fax,jdbcType=VARCHAR},
    #{juryLevel,jdbcType=VARCHAR}, #{recordDate,jdbcType=TIMESTAMP}, #{addtime,jdbcType=TIMESTAMP},
    #{adduserid,jdbcType=VARCHAR}, #{state,jdbcType=DECIMAL}, #{back1,jdbcType=VARCHAR},
    #{back2,jdbcType=VARCHAR}, #{back3,jdbcType=VARCHAR})
  </insert>
  <insert id="insertSelective" parameterType="com.hz.demo.model.base_judging">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Sep 13 15:09:53 CST 2018.
    -->
    insert into BASE_JUDGING
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="id != null">
        ID,
      </if>
      <if test="judgingCode != null">
        JUDGING_CODE,
      </if>
      <if test="judgingName != null">
        JUDGING_NAME,
      </if>
      <if test="reviewJurisdiction != null">
        REVIEW_JURISDICTION,
      </if>
      <if test="reviewScope != null">
        REVIEW_SCOPE,
      </if>
      <if test="buildUnit != null">
        BUILD_UNIT,
      </if>
      <if test="manageUnit != null">
        MANAGE_UNIT,
      </if>
      <if test="linkman != null">
        LINKMAN,
      </if>
      <if test="phone != null">
        PHONE,
      </if>
      <if test="email != null">
        EMAIL,
      </if>
      <if test="postalCode != null">
        POSTAL_CODE,
      </if>
      <if test="fax != null">
        FAX,
      </if>
      <if test="juryLevel != null">
        JURY_LEVEL,
      </if>
      <if test="recordDate != null">
        RECORD_DATE,
      </if>
      <if test="addtime != null">
        ADDTIME,
      </if>
      <if test="adduserid != null">
        ADDUSERID,
      </if>
      <if test="state != null">
        STATE,
      </if>
      <if test="back1 != null">
        BACK1,
      </if>
      <if test="back2 != null">
        BACK2,
      </if>
      <if test="back3 != null">
        BACK3,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="id != null">
        #{id,jdbcType=DECIMAL},
      </if>
      <if test="judgingCode != null">
        #{judgingCode,jdbcType=VARCHAR},
      </if>
      <if test="judgingName != null">
        #{judgingName,jdbcType=VARCHAR},
      </if>
      <if test="reviewJurisdiction != null">
        #{reviewJurisdiction,jdbcType=VARCHAR},
      </if>
      <if test="reviewScope != null">
        #{reviewScope,jdbcType=VARCHAR},
      </if>
      <if test="buildUnit != null">
        #{buildUnit,jdbcType=VARCHAR},
      </if>
      <if test="manageUnit != null">
        #{manageUnit,jdbcType=VARCHAR},
      </if>
      <if test="linkman != null">
        #{linkman,jdbcType=VARCHAR},
      </if>
      <if test="phone != null">
        #{phone,jdbcType=VARCHAR},
      </if>
      <if test="email != null">
        #{email,jdbcType=VARCHAR},
      </if>
      <if test="postalCode != null">
        #{postalCode,jdbcType=VARCHAR},
      </if>
      <if test="fax != null">
        #{fax,jdbcType=VARCHAR},
      </if>
      <if test="juryLevel != null">
        #{juryLevel,jdbcType=VARCHAR},
      </if>
      <if test="recordDate != null">
        #{recordDate,jdbcType=TIMESTAMP},
      </if>
      <if test="addtime != null">
        #{addtime,jdbcType=TIMESTAMP},
      </if>
      <if test="adduserid != null">
        #{adduserid,jdbcType=VARCHAR},
      </if>
      <if test="state != null">
        #{state,jdbcType=DECIMAL},
      </if>
      <if test="back1 != null">
        #{back1,jdbcType=VARCHAR},
      </if>
      <if test="back2 != null">
        #{back2,jdbcType=VARCHAR},
      </if>
      <if test="back3 != null">
        #{back3,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.hz.demo.model.base_judging">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Sep 13 15:09:53 CST 2018.
    -->
    update BASE_JUDGING
    <set>
      <if test="judgingCode != null">
        JUDGING_CODE = #{judgingCode,jdbcType=VARCHAR},
      </if>
      <if test="judgingName != null">
        JUDGING_NAME = #{judgingName,jdbcType=VARCHAR},
      </if>
      <if test="reviewJurisdiction != null">
        REVIEW_JURISDICTION = #{reviewJurisdiction,jdbcType=VARCHAR},
      </if>
      <if test="reviewScope != null">
        REVIEW_SCOPE = #{reviewScope,jdbcType=VARCHAR},
      </if>
      <if test="buildUnit != null">
        BUILD_UNIT = #{buildUnit,jdbcType=VARCHAR},
      </if>
      <if test="manageUnit != null">
        MANAGE_UNIT = #{manageUnit,jdbcType=VARCHAR},
      </if>
      <if test="linkman != null">
        LINKMAN = #{linkman,jdbcType=VARCHAR},
      </if>
      <if test="phone != null">
        PHONE = #{phone,jdbcType=VARCHAR},
      </if>
      <if test="email != null">
        EMAIL = #{email,jdbcType=VARCHAR},
      </if>
      <if test="postalCode != null">
        POSTAL_CODE = #{postalCode,jdbcType=VARCHAR},
      </if>
      <if test="fax != null">
        FAX = #{fax,jdbcType=VARCHAR},
      </if>
      <if test="juryLevel != null">
        JURY_LEVEL = #{juryLevel,jdbcType=VARCHAR},
      </if>
      <if test="recordDate != null">
        RECORD_DATE = #{recordDate,jdbcType=TIMESTAMP},
      </if>
      <if test="addtime != null">
        ADDTIME = #{addtime,jdbcType=TIMESTAMP},
      </if>
      <if test="adduserid != null">
        ADDUSERID = #{adduserid,jdbcType=VARCHAR},
      </if>
      <if test="state != null">
        STATE = #{state,jdbcType=DECIMAL},
      </if>
      <if test="back1 != null">
        BACK1 = #{back1,jdbcType=VARCHAR},
      </if>
      <if test="back2 != null">
        BACK2 = #{back2,jdbcType=VARCHAR},
      </if>
      <if test="back3 != null">
        BACK3 = #{back3,jdbcType=VARCHAR},
      </if>
      <if test="judgingProportion != null">
        JUDGING_PROPORTION = #{judgingProportion,jdbcType=VARCHAR},
      </if>
    </set>
    where ID = #{id,jdbcType=DECIMAL}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.hz.demo.model.base_judging">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Sep 13 15:09:53 CST 2018.
    -->
    update BASE_JUDGING
    set JUDGING_CODE = #{judgingCode,jdbcType=VARCHAR},
    JUDGING_NAME = #{judgingName,jdbcType=VARCHAR},
    REVIEW_JURISDICTION = #{reviewJurisdiction,jdbcType=VARCHAR},
    REVIEW_SCOPE = #{reviewScope,jdbcType=VARCHAR},
    BUILD_UNIT = #{buildUnit,jdbcType=VARCHAR},
    MANAGE_UNIT = #{manageUnit,jdbcType=VARCHAR},
    LINKMAN = #{linkman,jdbcType=VARCHAR},
    PHONE = #{phone,jdbcType=VARCHAR},
    EMAIL = #{email,jdbcType=VARCHAR},
    POSTAL_CODE = #{postalCode,jdbcType=VARCHAR},
    FAX = #{fax,jdbcType=VARCHAR},
    JURY_LEVEL = #{juryLevel,jdbcType=VARCHAR},
    RECORD_DATE = #{recordDate,jdbcType=TIMESTAMP},
    ADDTIME = #{addtime,jdbcType=TIMESTAMP},
    ADDUSERID = #{adduserid,jdbcType=VARCHAR},
    STATE = #{state,jdbcType=DECIMAL},
    BACK1 = #{back1,jdbcType=VARCHAR},
    BACK2 = #{back2,jdbcType=VARCHAR},
    BACK3 = #{back3,jdbcType=VARCHAR}
    where ID = #{id,jdbcType=DECIMAL}
  </update>
  <!--根据条件查询全部记录-->
  <select id="selectList" parameterType="pd" resultMap="BaseResultMap">
    select <include refid="Base_Column_List"/>
    from
    (select rownum rn,e.* from
    (select g.ID, g.JUDGING_CODE, g.JUDGING_NAME, g.REVIEW_JURISDICTION, g.REVIEW_SCOPE,g.BUILD_UNIT,d.unit_name as MANAGE_UNIT, g.LINKMAN, g.PHONE, g.EMAIL,g.POSTAL_CODE, g.FAX, g.JURY_LEVEL, g.RECORD_DATE, g.ADDTIME, g.ADDUSERID, g.STATE, g.BACK1, g.BACK2, g.BACK3 from(
    select a.ID, a.JUDGING_CODE, a.JUDGING_NAME, a.REVIEW_JURISDICTION, a.REVIEW_SCOPE, b.unit_name as BUILD_UNIT,
    a.MANAGE_UNIT, a.LINKMAN, a.PHONE, a.EMAIL, a.POSTAL_CODE, a.FAX, a.JURY_LEVEL, a.RECORD_DATE, a.ADDTIME,
    a.ADDUSERID, a.STATE, a.BACK1, bs.SPECIALITY_NAME BACK2, a.BACK3
    from  base_judging a left join base_unit b on a.BUILD_UNIT = b.unit_code
    left join BASE_ENGAGE ben on ben.JUDGING_ID=a.id and ben.JURY_DUTY=1
    left join BASE_SPECIALITY bs on bs.id=ben.SPECIALITY_ID
    WHERE a.back3='1'
    <if test="judgingName != null and judgingName!='' ">
      and a.JUDGING_NAME like '%'||#{judgingName}||'%'
    </if>
    <if test="manageUnit != null and manageUnit!=''">
      and a.MANAGE_UNIT = #{manageUnit,jdbcType=VARCHAR}
    </if>
    ORDER by a.addtime
    ) g left join base_unit d on g.MANAGE_UNIT = d.unit_code) e
    <if test="page != null and rows != null">
      where rownum &lt;=#{rows}*#{page}) f
      where  rn>(#{page}-1)*#{rows}
    </if>
  </select>
  <!--根据条件查询全部记录个数-->
  <select id="selectCount" parameterType="pd" resultType="Integer">
    select count(*) as listcount
    from base_judging WHERE back3='1'
    <if test="judgingName != null and judgingName!='' ">
      and JUDGING_NAME like '%'||#{judgingName}||'%'
    </if>
    <if test="manageUnit != null and manageUnit!=''">
      and MANAGE_UNIT = #{manageUnit,jdbcType=VARCHAR}
    </if>
  </select>
  <!--根据条件查询全部机构-->
  <select id="selectListWhere" parameterType="pd" resultType="Map">
    SELECT JUDGING_CODE as id,JUDGING_NAME as text  FROM
        BASE_JUDGING
    where BACK3='1'
        ORDER BY addtime desc
  </select>

  <!--根据评委会编码查询评委会等级-->
  <select id="getJudLevel" resultType="String">
    select dict_name from SYS_DICT where DICT_CODE= (select REVIEW_JURISDICTION from BASE_JUDGING where JUDGING_CODE=#{judCode,jdbcType=VARCHAR}) and GROUP_NAME='REVIEW_JURISDICTION'
  </select>

  <select id="updateIsDel" parameterType="com.hz.demo.model.base_judging">
    update BASE_JUDGING set back3 =#{back3,jdbcType=VARCHAR} where ID = #{id,jdbcType=DECIMAL}
  </select>

  <!--根据组建单位或管理单位查询全部评委会-->
  <select id="selectListWhereByUnit" parameterType="pd" resultType="Map">
    SELECT JUDGING_CODE as id,JUDGING_NAME as text  FROM
                                                         BASE_JUDGING
    where (BUILD_UNIT=#{BUILD_UNIT} or MANAGE_UNIT=#{BUILD_UNIT}) and BACK3='1'
    ORDER BY addtime desc
  </select>
  <select id="updateProportion" parameterType="pd" resultType="pd">
    update BASE_JUDGING set JUDGING_PROPORTION=#{JUDGING_PROPORTION}

    where JUDGING_CODE=#{JUDGING_CODE}
  </select>

  <select id="getModelWhere" parameterType="pd" resultMap="BaseResultMap">
    select
    <include refid="Base_Column_List"/>
    from BASE_JUDGING
    where back3='1'
    <if test="judgingCode != null">
      and JUDGING_CODE = #{judgingCode}
    </if>
    <if test="judgingName != null and judgingName!='' ">
      and JUDGING_NAME =#{judgingName}
    </if>
    <if test="id != null and id!=''">
      and ID != #{id}
    </if>
  </select>


</mapper>